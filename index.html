<!-- I need to put this here, dont ask why --><!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bread Quest: The Rise of the Dough</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background-color: #f7e7d5;
            margin: 0;
            overflow: hidden;
        }

        #gameCanvas {
            background-color: #f4dabe;
            display: block;
            margin: 0 auto;
        }

        #ui {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #5d3a1a;
        }

        .button {
            padding: 10px;
            background-color: #d7bfa6;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>

<body>
    <div id="ui">
        <h1>Bread Quest: The Rise of the Dough</h1>
        <button class="button" onclick="startGame()">Start Game</button>
        <p id="questLog"></p>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        let gameActive = false;
        let questIndex = 0;
        const quests = [
            "Welcome to Breadtopia! Collect flour in Yeast Meadows. üåæ",
            "Gather magic yeast in Sourdough Forest. üå≥",
            "Find rare spices in Rye Highlands. ‚õ∞Ô∏è",
            "Bake a powerful loaf to protect Breadtopia! ü•ñ"
        ];

        const player = {
            x: 50,
            y: 50,
            width: 50,
            height: 50,
            speed: 5
        };

        const resources = [];

        function startGame() {
            gameActive = true;
            questIndex = 0;
            updateQuestLog();
            populateResources();
            requestAnimationFrame(gameLoop);
        }

        function updateQuestLog() {
            document.getElementById('questLog').innerText = quests[questIndex];
        }

        function populateResources() {
            for (let i = 0; i < 10; i++) {
                resources.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    width: 30,
                    height: 30,
                    collected: false
                });
            }
        }

        function gameLoop() {
            if (!gameActive) return;
            update();
            render();
            requestAnimationFrame(gameLoop);
        }

        function update() {
            if (isArrowKeyDown('ArrowLeft')) player.x -= player.speed;
            if (isArrowKeyDown('ArrowRight')) player.x += player.speed;
            if (isArrowKeyDown('ArrowUp')) player.y -= player.speed;
            if (isArrowKeyDown('ArrowDown')) player.y += player.speed;

            resources.forEach(resource => {
                if (detectCollision(player, resource) && !resource.collected) {
                    resource.collected = true;
                }
            });

            if (resources.every(resource => resource.collected)) {
                questIndex++;
                if (questIndex < quests.length) {
                    updateQuestLog();
                    resources.forEach(resource => resource.collected = false);
                } else {
                    gameActive = false;
                    alert("Congratulations! You've baked the ultimate bread! üéâ");
                }
            }
        }

        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#ae6f43';
            ctx.fillRect(player.x, player.y, player.width, player.height);

            resources.forEach(resource => {
                if (!resource.collected) {
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(resource.x, resource.y, resource.width, resource.height);
                }
            });
        }

        function isArrowKeyDown(key) {
            return keys[key];
        }

        function detectCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                rect1.x + rect1.width > rect2.x &&
                rect1.y < rect2.y + rect2.height &&
                rect1.y + rect1.height > rect2.y;
        }

        const keys = {};
        window.addEventListener('keydown', (e) => {
            keys[e.key] = true;
        });

        window.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });
    </script>
</body>

</html>